import pandas as pd
from sklearn.linear_model import LogisticRegression
import csv
import numpy

train = pd.read_csv('/Users/hansgundlach/Downloads/swissfraudtrain.csv', header=0, sep=",", index_col=0, parse_dates=True)
feature_cols = ['category', 'turnover', 'transaction_count', 'io_ratio', 'age','is_pep', 'inactive_days_average', 'inactive_days_max', 'n_of_accounts']

X = train.loc[:, feature_cols]
y = train['suspicious']


clf = LogisticRegression(random_state=0, solver='lbfgs', multi_class='multinomial').fit(X, y)

#testing begins
test = pd.read_csv('/Users/hansgundlach/Downloads/swissfraudtest.csv', header=0, sep=",", index_col=0, parse_dates=True)

pred_test = list(clf.predict(X))
prob_test = list(clf.predict_proba(X))
prob_test_values = [i[1] for i in prob_test]
test['probs'] = prob_test_values

#sorted array of probabilites
a = test.sort_values(by="probs",ascending = "True")
highest = a.tail(1000)
inter = highest['probs']
final = inter.index
final = final.tolist()

option2 = pd.Series(final)
option2.to_csv('Logistic1Round2.csv')
option2


